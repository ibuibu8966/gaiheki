_# 機能要件定義書

## 1. 概要

本ドキュメントは、外壁塗装マッチングサイトに「加盟店向けダッシュボード」および「運営会社向け管理機能」を追加するにあたり、必要な機能要件を定義するものです。

## 2. ビジネスフロー

![ビジネスフロー図](https://private-us-east-1.manuscdn.com/sessionFile/b8YgRoIOvjS672LWGQVpxe/sandbox/RqJFc1kKXE0wobndYYE9hH-images_1760609152538_na1fn_L2hvbWUvdWJ1bnR1L2J1c2luZXNzX2Zsb3c.png?Policy=eyJTdGF0ZW1lbnQiOlt7IlJlc291cmNlIjoiaHR0cHM6Ly9wcml2YXRlLXVzLWVhc3QtMS5tYW51c2Nkbi5jb20vc2Vzc2lvbkZpbGUvYjhZZ1JvSU92alM2NzJMV0dRVnB4ZS9zYW5kYm94L1JxSkZjMWtLWEUwd29ibmRZWUU5aEgtaW1hZ2VzXzE3NjA2MDkxNTI1MzhfbmExZm5fTDJodmJXVXZkV0oxYm5SMUwySjFjMmx1WlhOelgyWnNiM2MucG5nIiwiQ29uZGl0aW9uIjp7IkRhdGVMZXNzVGhhbiI6eyJBV1M6RXBvY2hUaW1lIjoxNzk4NzYxNjAwfX19XX0_&Key-Pair-Id=K2HSFNDJXOU9YS&Signature=BWyyoatJB0w~TLer0WhJKfC9lvttwiz3F0lZPpeNBf27-ExRB0OlvO34oZDwGvI1F95brpUjJX-D8ILbk388Hj56c18np8ZbubZjSJkePiZtGSca56Qkps5Ida2gu-2gT32X~-eIHoOoKaRg818WCLDvsMvhG1sqK3TizfY3B~QBRHs0ls5PhKnttSfayOKRJIgJXhaOWIe1k5Ds8Uxwh1W12gSFP5u5SEpT5r6AfP2kYMBMd9mEMWhHSGSxgynlY6LDb~maYko5HVaoJvBfs2Hh3mt5ujc3eIa2Te5xsoY4rthjnypbj7Ia5encm5GE95~PTW1oQcaWM1ILJDjHtA__)

| ステップ | アクター | アクション |
| :--- | :--- | :--- |
| 1 | 顧客 | サイト上で診断依頼（問い合わせ）を行う。 |
| 2 | 加盟店 | 診断依頼に対し、見積もりを提出する。 |
| 3 | 顧客 | 提出された見積もりを比較し、加盟店を決定する。 |
| 4 | 加盟店 | 顧客から正式に受注し、施工を開始する。 |
| 5 | 加盟店 | 施工を完了させる。 |
| 6 | 加盟店 | **【新機能】** システム内で顧客向けの請求書を作成し、発行する。 |
| 7 | 顧客 | 請求書に基づき、加盟店に支払いを行う。 |
| 8 | 加盟店 | **【新機能】** システム上で入金確認を行う。 |
| 9 | 運営会社 | **【新機能】** 施工完了案件に基づき、プラットフォーム手数料を自動計算する。 |
| 10 | 運営会社 | **【新機能】** 月末締めで手数料請求書を生成し、加盟店に提示する。 |
| 11 | 加盟店 | 請求書に基づき、運営会社に手数料を支払う。 |
| 12 | 運営会社 | **【新機能】** システム上で入金確認を行う。 |

## 3. 機能要件

### 3.1. 加盟店向け機能

#### 3.1.1. ダッシュボード

加盟店がログイン後に表示されるトップページ。各種KPIを直感的に把握できる。

- **KPIサマリー表示**
    - 今月の問い合わせ件数
    - 今月の受注件数
    - 今月の施工完了件数
    - 今月の売上（顧客への請求額合計）
    - 未入金額（顧客からの未払い合計）
- **グラフ表示**
    - 月次売上推移グラフ（過去12ヶ月）
    - 案件ステータス別件数（円グラフ：問い合わせ、見積中、受注、施工中、施工完了）
- **表示期間の絞り込み**
    - デフォルトは「当月」を表示。
    - 「先月」「今年」「指定期間」での絞り込みが可能。

#### 3.1.2. 請求管理 (対顧客)

加盟店が顧客に対して発行する請求書を管理する機能。

- **請求書一覧**
    - 案件名、顧客名、請求額、発行日、支払期日、ステータス（下書き, 未払い, 支払い済み, 遅延）を一覧表示。
    - ステータスやキーワードで検索・絞り込みが可能。
- **請求書作成・編集**
    - 施工完了案件を選択し、請求書を作成。
    - 請求項目（品目、数量、単位、単価）を自由に編集可能。
    - 消費税（10%）を自動計算。
- **PDF出力**
    - 作成した請求書をPDF形式でダウンロードできる。
- **ステータス管理**
    - 「入金済み」ボタンでステータスを手動更新。
    - 支払期日を過ぎた未払い請求書は自動で「支払い遅延」ステータスになる。

### 3.2. 運営会社向け機能

#### 3.2.1. ダッシュボード

運営会社が全加盟店の状況を俯瞰的に把握するためのダッシュボード。

- **全体KPIサマリー**
    - 全加盟店の今月の総売上
    - 今月のプラットフォーム手数料売上
    - 今月の新規加盟店数
    - アクティブ加盟店数
- **加盟店別サマリー**
    - 加盟店ごとの受注件数、売上、手数料を一覧表示。
    - 月次での絞り込み機能。

#### 3.2.2. 請求管理 (対加盟店)

運営会社が加盟店に対して発行するプラットフォーム手数料の請求書を管理する機能。

- **請求書一覧**
    - 加盟店名、請求額、発行日、支払期日、ステータスを一覧表示。
- **請求書自動生成**
    - 月末に、各加盟店の料金プランと当月の活動（受注件数、施工完了件数）に基づき、請求データを自動生成。
- **請求書発行**
    - 「ワンクリックで発行」ボタンを押すと、生成された請求データが確定し、請求書が作成される（ステータスが「未払い」になる）。
- **PDF出力**
    - 発行した請求書をPDF形式でダウンロードできる。
- **ステータス管理**
    - 入金確認後、手動でステータスを「支払い済み」に更新。
    - 支払期日（設定画面で変更可能）を過ぎた請求書は自動で「支払い遅延」ステータスになり、アラート表示される。

#### 3.2.3. 設定機能

- **料金プラン設定**
    - プラットフォーム手数料の料金プランを作成・編集する機能。
    - プランには「月額固定」「受注ごとの固定額」「施工完了ごとの固定額」「施工完了ごとの料率」を自由に組み合わせて設定できる。
    - 全加盟店に一律で適用されるデフォルトプランを設定。
- **請求サイクル設定**
    - 請求の締め日と支払期日を設定できる。（例：月末締め、翌月20日払い）

## 4. 非機能要件

- **パフォーマンス**: ダッシュボードの表示は3秒以内に行われること。
- **セキュリティ**: 請求情報など、個人情報・金額に関わるデータは適切に保護されること。
- **UI/UX**: 各機能は直感的に操作可能であること。

